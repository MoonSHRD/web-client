type Group implements Node {
  id: ID!
  name: String
  avatarUrl: String
  shortDescription: String
  longDescription: String
  isPublic: Boolean
  joinPolicy: String
  rooms: [Room!]!
}

type GroupMembership {
  id: ID!
  groupId: String!
  userId: String!
  isAdmin: Boolean!
  membership: String!
  isPublicised: Boolean!
  content: String!
  group: Group!
}

input JoinInput {
  groupId: ID!
  clientMutationId: String
}

type JoinPayload {
  success: Boolean!
  clientMutationId: String
}

input LeaveInput {
  groupId: ID!
  clientMutationId: String
}

type LeavePayload {
  success: Boolean!
  clientMutationId: String
}

type MessageContent {
  body: String
}

type Mutation {
  join(input: JoinInput!): JoinPayload
  leave(input: LeaveInput!): LeavePayload
  uploadGroupAvatar(input: UploadGroupAvatarInput!): UploadGroupAvatarPayload
}

input NewRoomMessageInput {
  roomId: ID!
  clientSubscriptionId: String
}

type NewRoomMessagePayload {
  edge: RoomMessageEdge!
  clientSubscriptionId: String
}

"""An object with an ID"""
interface Node {
  """The id of the object."""
  id: ID!
}

"""Information about pagination in a connection."""
type PageInfo {
  """When paginating forwards, are there more items?"""
  hasNextPage: Boolean!

  """When paginating backwards, are there more items?"""
  hasPreviousPage: Boolean!

  """When paginating backwards, the cursor to continue."""
  startCursor: String

  """When paginating forwards, the cursor to continue."""
  endCursor: String
}

type Query {
  """Fetches an object given its ID"""
  node(
    """The ID of an object"""
    id: ID!
  ): Node
  viewer(accessToken: String, userId: String): Viewer
  user(id: ID!): User
  group(id: ID!): Group
  groups: [Group!]!
}

type Room implements Node {
  id: ID!
  isPublic: Boolean
  creator: String
  name: String
  messages(after: String, first: Int, before: String, last: Int): RoomMessageConnection
}

type RoomMessage {
  id: ID!
  roomId: String!
  sender: String
  age: String
  content: MessageContent!
}

"""A connection to a list of items."""
type RoomMessageConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [RoomMessageEdge]
}

"""An edge in a connection."""
type RoomMessageEdge {
  """The item at the end of the edge"""
  node: RoomMessage

  """A cursor for use in pagination"""
  cursor: String!
}

type Subscription {
  newRoomMessage(input: NewRoomMessageInput!): NewRoomMessagePayload
}

input UploadGroupAvatarInput {
  groupId: String!
  ext: String!
  clientMutationId: String
}

type UploadGroupAvatarPayload {
  postURL: String!
  formData: String!
  group: Group!
  clientMutationId: String
}

type User implements Node {
  """The ID of an object"""
  id: ID!
  name: String!
  ownGroups: [Group!]!
}

type Viewer {
  id: ID!
  groupMembership(isAdmin: Boolean): [GroupMembership!]!
  room(id: ID!): Room
}

